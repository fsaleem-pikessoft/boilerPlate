// Vulnerable function with multiple security issues
export const vulnerableFunction = (userInput: string) => {
  // Unsafe eval usage
  eval(userInput);

  // Unsafe regex with potential for ReDoS attack
  const dangerousRegex = new RegExp(userInput + "*");

  // Unsafe object injection
  const obj = {};
  obj[userInput] = "value";

  // Unsafe HTML injection
  const element = document.createElement("div");
  element.innerHTML = userInput;

  // Timing attack vulnerability
  const secretKey = "secret123";
  if (userInput === secretKey) {
    return true;
  }

  // Unsafe Buffer usage
  const buffer = new Buffer(userInput);

  return buffer;
};
